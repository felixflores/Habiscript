!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).nestml={})}(this,(function(e){"use strict";const t=/\.[^.#]+/g,s=/#[^.#]+/;function n(e,t={},s){const n=document.createElement(e);for(const[e,s]of Object.entries(t))if("style"===e&&"object"==typeof s)Object.assign(n.style,s);else if("function"==typeof s&&e.startsWith("on")){const t=e.substring(2).toLowerCase();n.addEventListener(t,s)}else void 0!==s&&n.setAttribute(e,s);for(const e of s)"string"==typeof e?n.appendChild(document.createTextNode(e)):e instanceof Node?n.appendChild(e):Array.isArray(e)&&n.appendChild(r(e));return n}function r(e){if("string"==typeof e)return document.createTextNode(e);if(e instanceof Node)return e;const[o,...i]=e;let a,c={};if("string"!=typeof o)throw new Error("The first element of the nestml array must be a string.");{a=o.split(/[#.]/)[0];const e=o.match(t),n=o.match(s);e&&(c.class=e.map((e=>e.substring(1))).join(" ")),n&&(c.id=n[0].substring(1))}i.length>0&&"object"==typeof i[0]&&!Array.isArray(i[0])&&Object.assign(c,i.shift());return n(a,c,i.flatMap((e=>Array.isArray(e)?r(e):e)))}e.Channel=class{constructor(){this.subscribers=[]}sub(e){this.subscribers.push(e)}unsub(e){this.subscribers=this.subscribers.filter((sub=>sub!==e))}pub(e){this.subscribers.forEach((sub=>sub(e)))}},e.classRegex=t,e.createElement=n,e.htmlToNestml=function e(t){if("string"==typeof t){return e((new DOMParser).parseFromString(t,"text/html").body.firstChild)}if(t.nodeType===Node.TEXT_NODE)return t.textContent;let s=t.tagName.toLowerCase();t.id&&(s+=`#${t.id}`),t.className&&(s+=`.${t.className.split(" ").join(".")}`);const n=[s],r={};for(const e of t.attributes)"class"!==e.name&&"id"!==e.name&&(r[e.name]=e.value);Object.keys(r).length>0&&n.push(r);for(const s of t.childNodes)n.push(e(s));return n},e.idRegex=s,e.nestmlToHtml=r}));
