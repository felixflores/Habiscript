!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Habiscript=t()}(this,(function(){"use strict";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t={exports:{}};!function(e,t){e.exports=function(){function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e){return i(e)?e:o(r({tnss:e}))}const n="__*__";function r({tnss:e,parent:t,css:o={},nested:i}){if(Array.isArray(e)&&"string"==typeof e[0]){const[r,...s]=e,f=`${r}:${a(s)};`,c=i?o[i]=o[i]||{}:o,l=t||n;c[l]=(c[l]||"")+f}else if(Array.isArray(e))for(let n of e)r({tnss:n,parent:t,css:o,nested:i});else for(let[n,a]of Object.entries(e))r({tnss:a,parent:n.startsWith("@")?t:s(t,n),css:o,nested:n.startsWith("@")?n:i});return o}function s(e,t){return e?e+(t.startsWith(":")?"":" ")+t:t}function o(e){return"object"!=typeof e||Array.isArray(e)||i(e)?e:Object.entries(e).map((([e,t])=>e===n?o(t):`${e}{${o(t)}}`)).join("")}function i(e){return!e||0===e.length||0===Object.keys(e).length}function a(e){return"string"==typeof e?e:e.func?`${e.func[0]}(${e.func.slice(1).join(",")})`:e.map(a).join(" ")}var f={style:t},c=e(f);return c}()}(t);var n=t.exports;const{style:r}=n,s=/\.[^.#]+/g,o=/#[^.#]+/;function i(e,t={},n){const s=document.createElement(e);for(const[e,n]of Object.entries(t))if("style"===e&&"object"==typeof n)Object.assign(s.style,a(r(n)));else if("function"==typeof n&&e.startsWith("on")){const t=e.substring(2).toLowerCase();s.addEventListener(t,n)}else void 0!==n&&s.setAttribute(e,n);for(const e of n)"string"==typeof e?s.appendChild(document.createTextNode(e)):e instanceof Node?s.appendChild(e):Array.isArray(e)&&s.appendChild(f(e));return s}function a(e){let t={};return e.split(";").forEach((e=>{let[n,r]=e.split(":");n&&r&&(n=n.trim(),n=n.replace(/-./g,(e=>e.charAt(1).toUpperCase())),t[n]=r.trim())})),t}function f(e){if("string"==typeof e)return document.createTextNode(e);if(e instanceof Node)return e;const[t,...n]=e;let r,a={};if("string"!=typeof t)throw new Error("The first element of the habiscript array must be a string.");{r=t.split(/[#.]/)[0];const e=t.match(s),n=t.match(o);e&&(a.class=e.map((e=>e.substring(1))).join(" ")),n&&(a.id=n[0].substring(1))}n.length>0&&"object"==typeof n[0]&&!Array.isArray(n[0])&&Object.assign(a,n.shift());return i(r,a,n.flatMap((e=>Array.isArray(e)?f(e):e)))}var c={createElement:i,habiToHtml:f,htmlToHabi:function e(t){if("string"==typeof t){return e((new DOMParser).parseFromString(t,"text/html").body.firstChild)}if(t.nodeType===Node.TEXT_NODE)return t.textContent;let n=t.tagName.toLowerCase();t.id&&(n+=`#${t.id}`),t.className&&(n+=`.${t.className.split(" ").join(".")}`);const r=[n],s={};return Array.from(t.attributes).forEach((e=>{"class"!==e.name&&"id"!==e.name&&("style"===e.name?(s[e.name]=s[e.name]||[],s[e.name].push(e.value.split(":").map((e=>e.replace(/;|\s/g,"").trim())))):s[e.name]=e.value)})),Object.keys(s).length>0&&r.push(s),Array.from(t.childNodes).forEach((t=>{r.push(e(t))})),r}};return e(c)}));
